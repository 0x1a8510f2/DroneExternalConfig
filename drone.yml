kind: pipeline
type: docker
name: default

steps:
- name: build binaries
  image: docker.io/golang:1.15-alpine
  commands:
    - mkdir build
    - GOOS=linux GOARCH=arm64 go build -v -o build/ .

- name: build and push docker image
  image: plugins/docker:linux-arm64
  settings:
    username:
      from_secret: DOCKER_USER
    password:
      from_secret: DOCKER_TOKEN
    repo: trslimey/drone-external-config
    auto_tag: true
